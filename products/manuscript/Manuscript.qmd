---
title: "Data Analysis Project"
subtitle: ""
author: Leah Lariscy
date: "`r Sys.Date()`"
format:
  html:
    toc: false
    number-sections: true
    highlight-style: github
bibliography: ../dataanalysis_template_references.bib
csl: ../apa.csl
---

```{r, echo=FALSE, message=FALSE}
# load a few R packages
library(here)
library(knitr)
library(tidyverse)
library(skimr)
```

# Summary/Abstract

*Write a summary of your project.*

{{< pagebreak >}}

# Introduction

## General Background Information

Infection by Severe Acute Respiratory Syndrome Coronavirus 2 (SARS-CoV-2), causing COVID-19, is followed by the shedding of viral particles by multiple excretory functions, including stool and urine production. Subsequently, these viral particles can be detected in wastewater influent via RNA extraction, followed by Reverse Transcriptase Quantitative Polymerase Chain Reaction (RT-qPCR) utilizing SARS-CoV-2 specific primers. Wastewater-based detection methods have been utilized across the globe as an independent and parallel indicator of SARS-CoV-2 viral prevalence and, depending on community-specific factors, as a leading indicator of clinical case trends. WBE methods may also become a primary tool in understanding transmission dynamics as case under-reporting increases.

## Description of data and data source

### Wastewater SARS-CoV-2 surveillance data

24-hour composite wastewater samples were collected twice weekly from three treatment facilities in Clarke County and refrigerated until ready for extraction. RNA extractions were performed for each sample in replicates (n=6). Reverse Transcriptase Quantitative Polymerase Chain Reaction (RT-qPCR) and SARS-CoV-2 specific primer-probe pairs were used to amplify each RNA extraction replicate in technical replicates (n=3). The concentration per reaction of each gene target was determined by the amplification standard curve from positive controls corresponding to the targets.

Wastewater influent flow data, including total daily flow volume and total suspended solids rate, were collected for each corresponding sample date. This was used to estimate the viral load of SARS-CoV-2, also known as total daily copies.

### COVID-19 testing data

COVID-19 data sets were downloaded from the Georgia Department of Public Health website (accessed Jan 2023), of which a subset was selected which includes symptom onset, PCR test, and PCR positive test data for each date since the first case was detected.

## Questions/Hypotheses to be addressed

Is there a relationship between viral load and clinical case observations?

Is there a relationship between qPCR percent positive and clinical case observations?

What do viral load trends look like over time?

What do clinical case trends look like over time?

How do each of these temporal trends compare to one another over time?

{{< pagebreak >}}

# Methods

## Data acquisition

**Wastewater SARS-CoV-2 viral load data** was obtained through weekly surveillance efforts utilizing RT-qPCR methods (Section 2.2).

**WWTP flow data** was obtained through data share directly from plant representatives.

**COVID-19 case data** was downloaded from Georgia Department of Public Health's COVID-19 Status Report Page in January 2023 \[x\].

## Data import and cleaning

### RT-qPCR data

For each target, viral copies per microliter (cp/uL) of each PCR reaction was estimated by transforming the cycle threshold value (Ct) using the appropriate standard curve equation. For reactions with no Ct value (no detection), cp/uL was set to the theoretical limit of detection (LOD). From this, N1 and N2 data frames were combined and copies per liter (cp/L) of sample for both targets was estimated using Equation 1.

```{r, echo=FALSE, message=FALSE}

readRDS(here("data/processed_data/year2_cfx_clean.rds")) %>% glimpse()

```

### Treatment plant flow data

For each collection date, corresponding , were combined with the qPCR data. Viral load (total daily viral copies) was then estimated by multiplying concentration estimates by daily flow volume (Equation 2).

```{r, echo=FALSE, message=FALSE}
readRDS(here("data/processed_data/year2_cfx_plant_combined.rds")) %>% glimpse()
```

### COVID testing data

Data frames were combined into one and filtered to include only data pertaining to Clarke County. Proportion of positive tests per day was calculated by dividing PCR positive tests by total PCR tests.

```{r, echo=FALSE, message=FALSE}
readRDS(here("data/processed_data/all_covid_combined.rds")) %>% glimpse()
```

## Statistical analysis

### Exploratory analysis

Wastewater and clinical data over time, linear regression model of wastewater vs clinical case data

### Predicting clinical case levels with wastewater surveillance data

Wastewater data as predictor for clinical case outcomes

{{< pagebreak >}}

# Results

## Descriptive analysis

```{r}
#| label: tbl-summarytable
#| tbl-cap: "Data summary table."
#| echo: FALSE
#resulttable=readRDS("../../results/summarytable.rds")
#knitr::kable(resulttable)
```

![Distribution of recorded seven-day moving average for each day](images/7DMA_histo.png)

![Distribution of viral load per sample collection per target](images/total_copies_histo.png)

```{r}
#| label: fig-result
#| fig-cap: "Height and weight stratified by gender."
#| echo: FALSE
#knitr::include_graphics(here("results","height_weight_stratified.png"))
```

![Clinical case seven-day moving average over time](images/7DMA_time_plot.png)

![Wastewater viral load over time](images/avg_total_copies_time.png)

## Basic statistical analysis

![Linear regression of viral load vs case seven-day moving average](images/total_copies_avg_vs_7DMA.png)

## Full analysis

```{r}
#| label: tbl-resulttable2
#| tbl-cap: "Linear model fit table."
#| echo: FALSE
#resulttable2 = readRDS(here("results","resulttable2.rds"))
#knitr::kable(resulttable2)
```

{{< pagebreak >}}

# Discussion

## Summary and Interpretation

*Summarize what you did, what you found and what it means.*

## Strengths and Limitations

*Discuss what you perceive as strengths and limitations of your analysis.*

## Conclusions

*What are the main take-home messages?*

*Include citations in your Rmd file using bibtex, the list of references will automatically be placed at the end*

This paper [@leek2015] discusses types of analyses.

These papers [@mckay2020; @mckay2020a] are good examples of papers published using a fully reproducible setup similar to the one shown in this template.

Note that this cited reference will show up at the end of the document, the reference formatting is determined by the CSL file specified in the YAML header. Many more style files for almost any journal [are available](https://www.zotero.org/styles). You also specify the location of your bibtex reference file in the YAML. You can call your reference file anything you like, I just used the generic word `references.bib` but giving it a more descriptive name is probably better.

{{< pagebreak >}}

# References
